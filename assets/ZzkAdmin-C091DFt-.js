import{h as Z,d as oe,c as Y,r as V,w as q,a as h,b as t,V as ae,o as c,e as l,f as r,g as K,i as v,j as s,t as y,k as R,l as U,m as B,n as fe,p as M,q as b,s as J,u as j,v as S,x,y as se,z as ne,A as ue,B as ge,C as ee,D as G,E,_ as ie,F as A,G as le,H as te,I as ve,J as ye,K as _e,L as be,M as Ve}from"./index-DcbC0nS-.js";const we=async i=>{console.log("🍎 发送添加水果请求:",i);try{const u={name:i.name,description:i.description||"",nutritionSummary:i.nutritionSummary||"",flavorProfile:i.flavorProfile||"",imageUrl:i.imageUrl||"",seasonInfo:i.seasonInfo||"",selectionTips:i.selectionTips||"",storageTips:i.storageTips||"",eatingTaboos:i.eatingTaboos||"",culturalSignificance:i.culturalSignificance||"",lifeProperties:i.lifeProperties||""};console.log("📤 处理后的请求数据:",u);const d=await Z.post("/fruit/addFruit",u);return console.log("✅ 添加水果成功:",d),d}catch(u){throw console.error("❌ 添加水果失败:",u),u}},he=async i=>{console.log("🗑️ 发送删除水果请求, ID:",i);try{const u=await Z.delete(`/fruit/deleteFruit/${i}`);return console.log("✅ 删除水果成功:",u),u}catch(u){throw console.error("❌ 删除水果失败:",u),u}},ke=async i=>{console.log("🔄 发送更新水果请求:",i);try{const u={id:i.id,name:i.name,description:i.description||"",nutritionSummary:i.nutritionSummary||"",flavorProfile:i.flavorProfile||"",imageUrl:i.imageUrl||"",seasonInfo:i.seasonInfo||"",selectionTips:i.selectionTips||"",storageTips:i.storageTips||"",eatingTaboos:i.eatingTaboos||"",culturalSignificance:i.culturalSignificance||"",lifeProperties:i.lifeProperties||""};console.log("📤 处理后的更新数据:",u);const d=await Z.put("/fruit/updateFruit",u);return console.log("✅ 更新水果成功:",d),d}catch(u){throw console.error("❌ 更新水果失败:",u),u}},xe=async i=>{console.log("🔍 发送分页查询水果请求:",i);try{const u=await Z.get("/fruit/getFruits",{params:{pageNum:i.pageNum,pageSize:i.pageSize,...i.keyword&&{keyword:i.keyword}}});return console.log("✅ 分页查询水果成功:",u),u}catch(u){throw console.error("❌ 分页查询水果失败:",u),u}},Pe=async i=>null,Se=async i=>null,Ue=async i=>null,Te=i=>{const u=[`https://picsum.photos/800/600?random=${Date.now()}`,`https://picsum.photos/800/600?blur=2&random=${Date.now()}`,`https://via.placeholder.com/800x600/4CAF50/FFFFFF?text=${encodeURIComponent(i)}`],d=Math.floor(Math.random()*u.length),w=u[d];return{url:w,thumbnailUrl:w,description:`${i}占位图`,source:"placeholder"}},$e=async i=>{console.log(`🖼️ 开始获取水果图片: ${i}`);const u=[Pe,Se,Ue];for(const d of u)try{const w=await d(i);if(w)return console.log("✅ 成功获取图片:",w),w}catch(w){console.warn("⚠️ 图片服务调用失败:",w);continue}return console.log(`🔄 使用占位符图片: ${i}`),Te(i)},ze=()=>({苹果:"https://images.unsplash.com/photo-1560806887-1e4cd0b6cbd6?w=800",香蕉:"https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?w=800",橙子:"https://images.unsplash.com/photo-1547514701-42782101795e?w=800",草莓:"https://images.unsplash.com/photo-1464965911861-746a04b4bca6?w=800",葡萄:"https://images.unsplash.com/photo-1537640538966-79f369143f8f?w=800",猕猴桃:"https://images.unsplash.com/photo-1585059895524-72359e06133a?w=800",樱桃:"https://images.unsplash.com/photo-1528821128474-27f963b062bf?w=800",桃子:"https://images.unsplash.com/photo-1629828430760-e1ca0ba35a8d?w=800",菠萝:"https://images.unsplash.com/photo-1550258987-190a2d41a8ba?w=800",西瓜:"https://images.unsplash.com/photo-1515594467324-eec77f71b4f6?w=800"}),Ce={class:"edit-header fruit-gradient"},Ie={class:"text-h5 font-weight-bold"},Fe={class:"section-title mb-4"},De={key:0,class:"mt-2"},Ae={class:"d-flex align-center justify-center fill-height"},Ne={class:"d-flex align-center justify-center fill-height text-red"},Ee={key:0,class:"text-caption text-grey mt-1"},Be={key:0},Me={class:"section-title mb-4"},Re={class:"section-title mb-4"},Le={class:"text-white"},Oe=oe({__name:"FruitEditDialog",props:{modelValue:{type:Boolean,default:!1},fruit:{default:null},isEdit:{type:Boolean,default:!1}},emits:["update:modelValue","fruit-saved"],setup(i,{emit:u}){const d=i,w=u,k=Y({get:()=>d.modelValue,set:p=>w("update:modelValue",p)}),C=V(),T=V(!1),n=V(!1),e=V({name:"",description:"",nutritionSummary:"",flavorProfile:"",imageUrl:"",seasonInfo:"",selectionTips:"",storageTips:"",eatingTaboos:"",culturalSignificance:"",lifeProperties:""}),_=V([]),H=["春季","夏季","秋季","冬季","全年"],N=["解暑","清热","适合甜点","促进食欲","美容养颜","增强免疫力","补充体力","缓解便秘","改善心情","促进消化","降血压","抗氧化","润肺止咳","护眼明目","补血养颜","健脾开胃","滋阴润燥","清肝明目","安神助眠","减肥瘦身","抗衰老","增强体质","生津止渴","化痰止咳"],L=[p=>!!p||"请输入水果名称",p=>p.length<=50||"水果名称不能超过50个字符"],I=V(!1),P=V(null),$=ze(),z=()=>{if(d.fruit){e.value={...d.fruit,description:d.fruit.description||"",nutritionSummary:d.fruit.nutritionSummary||"",flavorProfile:d.fruit.flavorProfile||"",imageUrl:d.fruit.imageUrl||"",seasonInfo:d.fruit.seasonInfo||"",selectionTips:d.fruit.selectionTips||"",storageTips:d.fruit.storageTips||"",eatingTaboos:d.fruit.eatingTaboos||"",culturalSignificance:d.fruit.culturalSignificance||"",lifeProperties:d.fruit.lifeProperties||""};try{d.fruit.lifeProperties&&d.fruit.lifeProperties.trim()?_.value=JSON.parse(d.fruit.lifeProperties):_.value=[]}catch(p){console.error("解析生活属性失败:",p),_.value=[]}}else e.value={name:"",description:"",nutritionSummary:"",flavorProfile:"",imageUrl:"",seasonInfo:"",selectionTips:"",storageTips:"",eatingTaboos:"",culturalSignificance:"",lifeProperties:""},_.value=[]},F=()=>{k.value=!1},Q=async()=>{if(!(!T.value||n.value)){n.value=!0;try{const p=_.value.length>0?JSON.stringify(_.value):"",a={...e.value,description:e.value.description||"",nutritionSummary:e.value.nutritionSummary||"",flavorProfile:e.value.flavorProfile||"",imageUrl:e.value.imageUrl||"",seasonInfo:e.value.seasonInfo||"",selectionTips:e.value.selectionTips||"",storageTips:e.value.storageTips||"",eatingTaboos:e.value.eatingTaboos||"",culturalSignificance:e.value.culturalSignificance||"",lifeProperties:p};console.log("💾 提交数据:",a),d.isEdit?(await ke(a)).code===200&&(w("fruit-saved",a),k.value=!1):(await we(a)).code===200&&(w("fruit-saved",a),k.value=!1)}catch(p){console.error("保存水果失败:",p)}finally{n.value=!1}}},W=async()=>{if(!e.value.name.trim()){D("请先输入水果名称","warning");return}I.value=!0;try{if($[e.value.name]){e.value.imageUrl=$[e.value.name],P.value={url:$[e.value.name],thumbnailUrl:$[e.value.name],description:`${e.value.name}图片`,source:"unsplash"},D(`已设置${e.value.name}的预设图片`,"success");return}const p=await $e(e.value.name);p?(e.value.imageUrl=p.url,P.value=p,D(`成功获取${e.value.name}的图片`,"success")):D("未找到合适的图片，请手动输入URL","warning")}catch(p){console.error("获取图片失败:",p),D("获取图片失败，请手动输入URL","error")}finally{I.value=!1}},X=p=>({unsplash:"Unsplash",pixabay:"Pixabay",pexels:"Pexels",placeholder:"占位图"})[p]||"未知来源";q(()=>e.value.name,p=>{p&&!e.value.imageUrl&&!d.isEdit&&setTimeout(()=>{$[p]&&(e.value.imageUrl=$[p])},500)});const D=(p,a="success")=>{console.log(`${a.toUpperCase()}: ${p}`)};return q(k,p=>{p&&z()}),(p,a)=>(c(),h(ae,{modelValue:k.value,"onUpdate:modelValue":a[12]||(a[12]=f=>k.value=f),"max-width":"900",persistent:"",scrollable:""},{default:t(()=>[l(E,{class:"fruit-edit-card",elevation:"12",rounded:"xl"},{default:t(()=>[r("div",Ce,[l(K,{class:"text-white d-flex align-center"},{default:t(()=>[l(v,{color:"white",class:"mr-3",size:"large"},{default:t(()=>[s(y(p.isEdit?"mdi-pencil":"mdi-plus"),1)]),_:1}),r("span",Ie,y(p.isEdit?"编辑水果信息":"添加新水果"),1),l(R),l(U,{icon:"",variant:"text",onClick:F,class:"close-btn"},{default:t(()=>[l(v,{color:"white"},{default:t(()=>a[13]||(a[13]=[s("mdi-close")])),_:1,__:[13]})]),_:1})]),_:1})]),l(B,{class:"pa-6",style:{"max-height":"700px"}},{default:t(()=>[l(fe,{modelValue:T.value,"onUpdate:modelValue":a[11]||(a[11]=f=>T.value=f),ref_key:"formRef",ref:C},{default:t(()=>[l(M,null,{default:t(()=>[l(b,{cols:"12"},{default:t(()=>[r("h3",Fe,[l(v,{color:"primary",class:"mr-2"},{default:t(()=>a[14]||(a[14]=[s("mdi-information")])),_:1,__:[14]}),a[15]||(a[15]=s(" 基本信息 "))])]),_:1}),l(b,{cols:"12",md:"6"},{default:t(()=>[l(J,{modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=f=>e.value.name=f),label:"水果名称 *","prepend-inner-icon":"mdi-fruit-cherries",variant:"outlined",color:"primary",rules:L,maxlength:"50",counter:"",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",md:"6"},{default:t(()=>[l(J,{modelValue:e.value.flavorProfile,"onUpdate:modelValue":a[1]||(a[1]=f=>e.value.flavorProfile=f),label:"口味特征","prepend-inner-icon":"mdi-emoticon-tongue",variant:"outlined",color:"pink",placeholder:"例如：酸甜、清爽、醇厚",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12"},{default:t(()=>[l(j,{modelValue:e.value.description,"onUpdate:modelValue":a[2]||(a[2]=f=>e.value.description=f),label:"水果描述","prepend-inner-icon":"mdi-text",variant:"outlined",color:"primary",rows:"3",maxlength:"500",counter:"",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12"},{default:t(()=>[l(J,{modelValue:e.value.nutritionSummary,"onUpdate:modelValue":a[3]||(a[3]=f=>e.value.nutritionSummary=f),label:"营养概览","prepend-inner-icon":"mdi-nutrition",variant:"outlined",color:"success",placeholder:"例如：富含维生素C和膳食纤维",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",md:"8"},{default:t(()=>[l(J,{modelValue:e.value.imageUrl,"onUpdate:modelValue":a[4]||(a[4]=f=>e.value.imageUrl=f),label:"图片URL","prepend-inner-icon":"mdi-image",variant:"outlined",color:"blue",placeholder:"请输入图片链接或点击自动获取",rounded:"lg"},{append:t(()=>[l(U,{color:"primary",variant:"text",size:"small",onClick:W,loading:I.value},{default:t(()=>[l(v,{start:"",size:"small"},{default:t(()=>a[16]||(a[16]=[s("mdi-auto-fix")])),_:1,__:[16]}),a[17]||(a[17]=s(" 自动获取 "))]),_:1,__:[17]},8,["loading"])]),_:1},8,["modelValue"]),e.value.imageUrl?(c(),S("div",De,[l(se,{src:e.value.imageUrl,alt:e.value.name,height:"120",width:"200",cover:"",rounded:"lg",class:"image-preview"},{placeholder:t(()=>[r("div",Ae,[l(ne,{indeterminate:"",color:"primary"})])]),error:t(()=>[r("div",Ne,[l(v,null,{default:t(()=>a[18]||(a[18]=[s("mdi-image-broken-variant")])),_:1,__:[18]}),a[19]||(a[19]=r("span",{class:"ml-2"},"图片加载失败",-1))])]),_:1},8,["src","alt"]),P.value?(c(),S("div",Ee,[s(" 来源: "+y(X(P.value.source))+" ",1),P.value.author?(c(),S("span",Be," - "+y(P.value.author),1)):x("",!0)])):x("",!0)])):x("",!0)]),_:1}),l(b,{cols:"12",md:"4"},{default:t(()=>[l(ue,{modelValue:e.value.seasonInfo,"onUpdate:modelValue":a[5]||(a[5]=f=>e.value.seasonInfo=f),label:"应季信息","prepend-inner-icon":"mdi-calendar",variant:"outlined",color:"orange",items:H,rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12"},{default:t(()=>[r("h3",Me,[l(v,{color:"success",class:"mr-2"},{default:t(()=>a[20]||(a[20]=[s("mdi-tag-multiple")])),_:1,__:[20]}),a[21]||(a[21]=s(" 生活属性标签 "))]),l(ge,{modelValue:_.value,"onUpdate:modelValue":a[6]||(a[6]=f=>_.value=f),label:"生活属性","prepend-inner-icon":"mdi-tag",variant:"outlined",color:"success",multiple:"",chips:"","closable-chips":"",items:N,placeholder:"选择或输入属性标签",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12"},{default:t(()=>[r("h3",Re,[l(v,{color:"info",class:"mr-2"},{default:t(()=>a[22]||(a[22]=[s("mdi-book-open")])),_:1,__:[22]}),a[23]||(a[23]=s(" 详细信息 "))])]),_:1}),l(b,{cols:"12",md:"6"},{default:t(()=>[l(j,{modelValue:e.value.selectionTips,"onUpdate:modelValue":a[7]||(a[7]=f=>e.value.selectionTips=f),label:"挑选技巧","prepend-inner-icon":"mdi-eye-check",variant:"outlined",color:"info",rows:"3",placeholder:"例如：颜色鲜亮，表皮无斑点",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",md:"6"},{default:t(()=>[l(j,{modelValue:e.value.storageTips,"onUpdate:modelValue":a[8]||(a[8]=f=>e.value.storageTips=f),label:"储存方法","prepend-inner-icon":"mdi-fridge",variant:"outlined",color:"blue",rows:"3",placeholder:"例如：常温保存，避免阳光直射",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",md:"6"},{default:t(()=>[l(j,{modelValue:e.value.eatingTaboos,"onUpdate:modelValue":a[9]||(a[9]=f=>e.value.eatingTaboos=f),label:"食用禁忌","prepend-inner-icon":"mdi-alert-circle",variant:"outlined",color:"warning",rows:"3",placeholder:"例如：不宜与海鲜同食，空腹不宜多食",rounded:"lg"},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",md:"6"},{default:t(()=>[l(j,{modelValue:e.value.culturalSignificance,"onUpdate:modelValue":a[10]||(a[10]=f=>e.value.culturalSignificance=f),label:"文化寓意","prepend-inner-icon":"mdi-account-group",variant:"outlined",color:"purple",rows:"3",placeholder:"例如：苹果在中国文化中象征平安，寓意吉祥如意",rounded:"lg"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(ee),l(G,{class:"pa-4"},{default:t(()=>[l(U,{variant:"outlined",color:"grey",onClick:F,class:"action-btn"},{default:t(()=>[l(v,{start:""},{default:t(()=>a[24]||(a[24]=[s("mdi-close")])),_:1,__:[24]}),a[25]||(a[25]=s(" 取消 "))]),_:1,__:[25]}),l(R),l(U,{color:"primary",variant:"elevated",onClick:Q,loading:n.value,disabled:!T.value,class:"action-btn fruit-gradient-btn"},{default:t(()=>[l(v,{start:"",color:"white"},{default:t(()=>a[26]||(a[26]=[s("mdi-check")])),_:1,__:[26]}),r("span",Le,y(p.isEdit?"更新":"添加"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),je=ie(Oe,[["__scopeId","data-v-91bfa29c"]]),Je={class:"detail-header fruit-gradient"},qe={class:"fruit-basic-section pa-6"},Ke={class:"fruit-image-container"},Ge={key:1,class:"fruit-placeholder"},Ze={class:"fruit-title mb-3"},He={class:"fruit-description mb-3"},Qe={class:"quick-info mb-3"},We={key:0,class:"nutrition-section"},Xe={class:"section-title mb-2"},Ye={class:"section-content"},el={key:0,class:"life-properties-section pa-6"},ll={class:"section-title mb-3"},tl={class:"d-flex flex-wrap gap-2"},ol={class:"detail-sections pa-6"},al={class:"info-section"},sl={class:"section-title mb-2"},il={class:"section-content"},rl={class:"info-section"},nl={class:"section-title mb-2"},ul={class:"section-content"},dl={class:"info-section warning-section"},ml={class:"section-title mb-2"},cl={class:"section-content"},pl={class:"info-section cultural-section"},fl={class:"section-title mb-2"},gl={class:"section-content"},vl=oe({__name:"FruitDetailDialog",props:{modelValue:{type:Boolean,default:!1},fruit:{default:null}},emits:["update:modelValue"],setup(i,{emit:u}){const d=i,w=u,k=Y({get:()=>d.modelValue,set:n=>w("update:modelValue",n)}),C=Y(()=>!1);q(()=>d.fruit,n=>{C.value&&console.log("🔍 FruitDetailDialog 接收到水果数据:",n)},{immediate:!0}),q(k,n=>{C.value&&console.log("🔍 FruitDetailDialog 对话框状态:",n?"打开":"关闭")});const T=n=>{if(!(n!=null&&n.lifeProperties))return[];try{if(Array.isArray(n.lifeProperties))return n.lifeProperties;if(typeof n.lifeProperties=="string"){const e=JSON.parse(n.lifeProperties);return Array.isArray(e)?e:[]}return[]}catch(e){return console.error("解析生活属性失败:",e,n.lifeProperties),[]}};return(n,e)=>(c(),h(ae,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=_=>k.value=_),"max-width":"800",scrollable:""},{default:t(()=>[l(E,{class:"fruit-detail-card",elevation:"12",rounded:"xl"},{default:t(()=>[r("div",Je,[l(K,{class:"text-white d-flex align-center"},{default:t(()=>[l(v,{color:"white",class:"mr-3",size:"large"},{default:t(()=>e[3]||(e[3]=[s("mdi-information")])),_:1,__:[3]}),e[5]||(e[5]=r("span",{class:"text-h5 font-weight-bold"},"水果详情",-1)),l(R),l(U,{icon:"",variant:"text",onClick:e[0]||(e[0]=_=>k.value=!1),class:"close-btn"},{default:t(()=>[l(v,{color:"white"},{default:t(()=>e[4]||(e[4]=[s("mdi-close")])),_:1,__:[4]})]),_:1})]),_:1,__:[5]})]),n.fruit?(c(),h(B,{key:0,class:"pa-0",style:{"max-height":"700px"}},{default:t(()=>[r("div",qe,[l(M,null,{default:t(()=>[l(b,{cols:"12",md:"4"},{default:t(()=>[r("div",Ke,[n.fruit.imageUrl?(c(),h(se,{key:0,src:n.fruit.imageUrl,alt:n.fruit.name,height:"200",cover:"",rounded:"lg",class:"fruit-image"},null,8,["src","alt"])):(c(),S("div",Ge,[l(v,{size:"80",color:"grey-lighten-2"},{default:t(()=>e[6]||(e[6]=[s("mdi-image-off")])),_:1,__:[6]}),e[7]||(e[7]=r("div",{class:"text-caption text-grey mt-2"},"暂无图片",-1))]))])]),_:1}),l(b,{cols:"12",md:"8"},{default:t(()=>[r("h2",Ze,y(n.fruit.name),1),r("p",He,y(n.fruit.description||"暂无描述"),1),r("div",Qe,[n.fruit.flavorProfile?(c(),h(A,{key:0,color:"pink",variant:"tonal",class:"mr-2 mb-2"},{default:t(()=>[l(v,{start:"",size:"small"},{default:t(()=>e[8]||(e[8]=[s("mdi-emoticon-tongue")])),_:1,__:[8]}),s(" "+y(n.fruit.flavorProfile),1)]),_:1})):x("",!0),n.fruit.seasonInfo?(c(),h(A,{key:1,color:"orange",variant:"tonal",class:"mr-2 mb-2"},{default:t(()=>[l(v,{start:"",size:"small"},{default:t(()=>e[9]||(e[9]=[s("mdi-calendar")])),_:1,__:[9]}),s(" "+y(n.fruit.seasonInfo),1)]),_:1})):x("",!0)]),n.fruit.nutritionSummary?(c(),S("div",We,[r("h4",Xe,[l(v,{color:"success",class:"mr-2"},{default:t(()=>e[10]||(e[10]=[s("mdi-nutrition")])),_:1,__:[10]}),e[11]||(e[11]=s(" 营养价值 "))]),r("p",Ye,y(n.fruit.nutritionSummary),1)])):x("",!0)]),_:1})]),_:1})]),l(ee),T(n.fruit).length?(c(),S("div",el,[r("h4",ll,[l(v,{color:"primary",class:"mr-2"},{default:t(()=>e[12]||(e[12]=[s("mdi-tag-multiple")])),_:1,__:[12]}),e[13]||(e[13]=s(" 生活属性 "))]),r("div",tl,[(c(!0),S(le,null,te(T(n.fruit),_=>(c(),h(A,{key:_,color:"primary",variant:"tonal",size:"small"},{default:t(()=>[s(y(_),1)]),_:2},1024))),128))])])):x("",!0),T(n.fruit).length?(c(),h(ee,{key:1})):x("",!0),r("div",ol,[l(M,null,{default:t(()=>[n.fruit.selectionTips?(c(),h(b,{key:0,cols:"12",md:"6"},{default:t(()=>[r("div",al,[r("h4",sl,[l(v,{color:"info",class:"mr-2"},{default:t(()=>e[14]||(e[14]=[s("mdi-eye-check")])),_:1,__:[14]}),e[15]||(e[15]=s(" 挑选技巧 "))]),r("p",il,y(n.fruit.selectionTips),1)])]),_:1})):x("",!0),n.fruit.storageTips?(c(),h(b,{key:1,cols:"12",md:"6"},{default:t(()=>[r("div",rl,[r("h4",nl,[l(v,{color:"blue",class:"mr-2"},{default:t(()=>e[16]||(e[16]=[s("mdi-fridge")])),_:1,__:[16]}),e[17]||(e[17]=s(" 储存方法 "))]),r("p",ul,y(n.fruit.storageTips),1)])]),_:1})):x("",!0),n.fruit.eatingTaboos?(c(),h(b,{key:2,cols:"12",md:"6"},{default:t(()=>[r("div",dl,[r("h4",ml,[l(v,{color:"warning",class:"mr-2"},{default:t(()=>e[18]||(e[18]=[s("mdi-alert-circle")])),_:1,__:[18]}),e[19]||(e[19]=s(" 食用禁忌 "))]),r("p",cl,y(n.fruit.eatingTaboos),1)])]),_:1})):x("",!0),n.fruit.culturalSignificance?(c(),h(b,{key:3,cols:"12",md:"6"},{default:t(()=>[r("div",pl,[r("h4",fl,[l(v,{color:"purple",class:"mr-2"},{default:t(()=>e[20]||(e[20]=[s("mdi-account-group")])),_:1,__:[20]}),e[21]||(e[21]=s(" 文化寓意 "))]),r("p",gl,y(n.fruit.culturalSignificance),1)])]),_:1})):x("",!0)]),_:1})])]),_:1})):(c(),h(B,{key:1,class:"pa-6 text-center"},{default:t(()=>[l(v,{size:"64",color:"grey-lighten-2"},{default:t(()=>e[22]||(e[22]=[s("mdi-alert-circle")])),_:1,__:[22]}),e[23]||(e[23]=r("div",{class:"text-h6 mt-4 text-grey"},"暂无水果数据",-1))]),_:1,__:[23]})),l(G,{class:"pa-4"},{default:t(()=>[l(R),l(U,{color:"primary",variant:"elevated",onClick:e[1]||(e[1]=_=>k.value=!1)},{default:t(()=>[l(v,{start:""},{default:t(()=>e[24]||(e[24]=[s("mdi-check")])),_:1,__:[24]}),e[25]||(e[25]=s(" 确定 "))]),_:1,__:[25]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),yl=ie(vl,[["__scopeId","data-v-8a042dab"]]),_l={class:"admin-container"},bl={class:"toolbar-section mb-6"},Vl={class:"fruits-section"},wl={key:0,class:"text-center py-12"},hl={key:1,class:"text-center py-12"},kl={key:2,class:"fruits-list-container"},xl={class:"fruit-image-section"},Pl={key:1,class:"fruit-placeholder"},Sl={class:"fruit-title mb-2"},Ul={class:"fruit-description text-body-2 text-grey-darken-1 mb-3"},Tl={class:"fruit-tags mb-3"},$l={key:0,class:"life-properties mb-3"},zl={class:"d-flex flex-wrap gap-1"},Cl={key:3,class:"pagination-section mt-6"},Il={class:"text-body-2 text-grey"},Fl={class:"d-flex align-center justify-center justify-md-end"},Dl=oe({__name:"ZzkAdmin",setup(i){const u=V(!1),d=V(!1),w=V([]),k=V(""),C=V(!1),T=V(""),n=V("success"),e=V({page:1,pageSize:12}),_=V({pageNum:1,pageSize:12,total:0,pages:0,list:[],hasNextPage:!1,hasPreviousPage:!1}),H=V([6,12,24,48]),N=V(!1),L=V(!1),I=V(!1),P=V(null),$=V(!1),z=async()=>{u.value=!0;try{const g={pageNum:e.value.page,pageSize:e.value.pageSize,...k.value&&{keyword:k.value}},o=await xe(g);o.code===200&&o.data&&(w.value=o.data.list||[],_.value=o.data)}catch(g){console.error("加载水果列表失败:",g),f("加载水果列表失败","error")}finally{u.value=!1}},F=g=>{if(!g.lifeProperties)return[];try{if(Array.isArray(g.lifeProperties))return g.lifeProperties;if(typeof g.lifeProperties=="string"){if(!g.lifeProperties.trim())return[];const o=JSON.parse(g.lifeProperties);return Array.isArray(o)?o:[]}return[]}catch(o){return console.error("解析生活属性失败:",o,g.lifeProperties),[]}},Q=()=>{P.value=null,$.value=!1,N.value=!0},W=g=>{console.log("🔍 查看水果详情:",g),P.value=g,L.value=!0},X=g=>{console.log("✏️ 编辑水果:",g),P.value=g,$.value=!0,N.value=!0},D=g=>{console.log("🗑️ 确认删除水果:",g),P.value=g,I.value=!0},p=async()=>{var g;if(!(!((g=P.value)!=null&&g.id)||d.value)){d.value=!0;try{const o=await he(P.value.id);o.code===200?(f("删除水果成功","success"),I.value=!1,await z()):f(o.msg||"删除失败","error")}catch(o){console.error("删除水果失败:",o),f("删除水果失败","error")}finally{d.value=!1}}},a=()=>{f($.value?"更新水果成功":"添加水果成功","success"),z()},f=(g,o="success")=>{T.value=g,n.value=o,C.value=!0},re=()=>{e.value.page=1,z()},de=()=>{k.value="",e.value.page=1,z()},me=()=>{z()},ce=g=>{e.value.page=g,z()},pe=g=>{e.value.pageSize=g,e.value.page=1,z()};return ve(()=>{z()}),(g,o)=>(c(),S("div",_l,[l(E,{class:"admin-header",elevation:"0",rounded:"0"},{default:t(()=>[l(K,{class:"text-center text-white"},{default:t(()=>[l(v,{color:"white",class:"mr-3",size:"large"},{default:t(()=>o[9]||(o[9]=[s("mdi-shield-crown")])),_:1,__:[9]}),o[10]||(o[10]=r("span",{class:"text-h4 font-weight-bold"},"水果管理后台",-1))]),_:1,__:[10]}),l(_e,{class:"text-center text-white opacity-90"},{default:t(()=>o[11]||(o[11]=[s(" 管理和维护水果信息数据库 ")])),_:1,__:[11]})]),_:1}),l(E,{class:"content-card",elevation:"8",rounded:"xl"},{default:t(()=>[l(B,{class:"pa-8"},{default:t(()=>[r("div",bl,[l(M,{align:"center"},{default:t(()=>[l(b,{cols:"12",md:"6"},{default:t(()=>[l(J,{modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=m=>k.value=m),label:"搜索水果","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"",clearable:"",onKeyup:be(re,["enter"]),"onClick:clear":de,class:"search-input",rounded:"lg"},{append:t(()=>[l(U,{color:"primary",variant:"flat",onClick:re,class:"search-btn"},{default:t(()=>o[12]||(o[12]=[s(" 搜索 ")])),_:1,__:[12]})]),_:1},8,["modelValue"])]),_:1}),l(b,{cols:"12",md:"6",class:"text-md-right"},{default:t(()=>[l(U,{color:"primary",variant:"elevated",onClick:Q,class:"fruit-gradient-btn mr-3",size:"large"},{default:t(()=>[l(v,{start:""},{default:t(()=>o[13]||(o[13]=[s("mdi-plus")])),_:1,__:[13]}),o[14]||(o[14]=s(" 添加水果 "))]),_:1,__:[14]}),l(U,{color:"success",variant:"outlined",onClick:me,size:"large"},{default:t(()=>[l(v,{start:""},{default:t(()=>o[15]||(o[15]=[s("mdi-refresh")])),_:1,__:[15]}),o[16]||(o[16]=s(" 刷新 "))]),_:1,__:[16]})]),_:1})]),_:1})]),r("div",Vl,[u.value?(c(),S("div",wl,[l(ne,{color:"primary",size:"64",indeterminate:""}),o[17]||(o[17]=r("div",{class:"text-h6 mt-4 text-grey"},"加载中...",-1))])):w.value.length===0?(c(),S("div",hl,[l(v,{color:"grey-lighten-2",size:"120"},{default:t(()=>o[18]||(o[18]=[s("mdi-fruit-grapes-outline")])),_:1,__:[18]}),o[19]||(o[19]=r("div",{class:"text-h5 mt-4 text-grey"},"暂无水果数据",-1)),o[20]||(o[20]=r("div",{class:"text-body-1 mt-2 text-grey"},'点击上方"添加水果"按钮开始添加',-1))])):(c(),S("div",kl,[l(M,null,{default:t(()=>[(c(!0),S(le,null,te(w.value,m=>(c(),h(b,{key:m.id,cols:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[l(E,{class:"fruit-card",elevation:"4",rounded:"xl",hover:""},{default:t(()=>[r("div",xl,[m.imageUrl?(c(),h(se,{key:0,src:m.imageUrl,alt:m.name,height:"200",cover:"",class:"fruit-image"},null,8,["src","alt"])):(c(),S("div",Pl,[l(v,{size:"80",color:"grey-lighten-2"},{default:t(()=>o[21]||(o[21]=[s("mdi-image-off")])),_:1,__:[21]}),o[22]||(o[22]=r("div",{class:"text-caption text-grey mt-2"},"暂无图片",-1))]))]),l(B,{class:"pa-4"},{default:t(()=>[r("h3",Sl,y(m.name),1),r("p",Ul,y(m.description||"暂无描述"),1),r("div",Tl,[m.seasonInfo?(c(),h(A,{key:0,color:"orange",size:"small",variant:"tonal",class:"mr-2 mb-1"},{default:t(()=>[s(y(m.seasonInfo),1)]),_:2},1024)):x("",!0),m.flavorProfile?(c(),h(A,{key:1,color:"pink",size:"small",variant:"tonal",class:"mr-2 mb-1"},{default:t(()=>[s(y(m.flavorProfile),1)]),_:2},1024)):x("",!0)]),F(m).length?(c(),S("div",$l,[o[23]||(o[23]=r("div",{class:"text-caption text-grey mb-1"},"生活属性:",-1)),r("div",zl,[(c(!0),S(le,null,te(F(m).slice(0,3),O=>(c(),h(A,{key:O,color:"primary",size:"x-small",variant:"tonal"},{default:t(()=>[s(y(O),1)]),_:2},1024))),128)),F(m).length>3?(c(),h(A,{key:0,color:"grey",size:"x-small",variant:"tonal"},{default:t(()=>[s(" +"+y(F(m).length-3),1)]),_:2},1024)):x("",!0)])])):x("",!0)]),_:2},1024),l(G,{class:"pa-4 pt-0"},{default:t(()=>[l(U,{color:"info",variant:"text",size:"small",onClick:O=>W(m)},{default:t(()=>[l(v,{start:"",size:"small"},{default:t(()=>o[24]||(o[24]=[s("mdi-eye")])),_:1,__:[24]}),o[25]||(o[25]=s(" 查看 "))]),_:2,__:[25]},1032,["onClick"]),l(U,{color:"primary",variant:"text",size:"small",onClick:O=>X(m)},{default:t(()=>[l(v,{start:"",size:"small"},{default:t(()=>o[26]||(o[26]=[s("mdi-pencil")])),_:1,__:[26]}),o[27]||(o[27]=s(" 编辑 "))]),_:2,__:[27]},1032,["onClick"]),l(R),l(U,{color:"error",variant:"text",size:"small",onClick:O=>D(m)},{default:t(()=>[l(v,{start:"",size:"small"},{default:t(()=>o[28]||(o[28]=[s("mdi-delete")])),_:1,__:[28]}),o[29]||(o[29]=s(" 删除 "))]),_:2,__:[29]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])),w.value.length>0?(c(),S("div",Cl,[l(M,{align:"center",justify:"center"},{default:t(()=>[l(b,{cols:"12",md:"6",class:"text-center text-md-left"},{default:t(()=>[r("div",Il," 显示第 "+y(_.value.pageNum)+" 页，共 "+y(_.value.total)+" 条记录 (第 "+y((_.value.pageNum-1)*_.value.pageSize+1)+"-"+y(Math.min(_.value.pageNum*_.value.pageSize,_.value.total))+" 条) ",1)]),_:1}),l(b,{cols:"12",md:"6"},{default:t(()=>[r("div",Fl,[l(ue,{modelValue:e.value.pageSize,"onUpdate:modelValue":[o[1]||(o[1]=m=>e.value.pageSize=m),pe],items:H.value,label:"每页显示",variant:"outlined","hide-details":"",density:"compact",class:"page-size-select mr-4"},null,8,["modelValue","items"]),l(Ve,{modelValue:e.value.page,"onUpdate:modelValue":[o[2]||(o[2]=m=>e.value.page=m),ce],length:_.value.pages,"total-visible":5,color:"primary",class:"pagination-control"},null,8,["modelValue","length"])])]),_:1})]),_:1})])):x("",!0)])]),_:1})]),_:1}),l(je,{modelValue:N.value,"onUpdate:modelValue":o[3]||(o[3]=m=>N.value=m),fruit:P.value,"is-edit":$.value,onFruitSaved:a},null,8,["modelValue","fruit","is-edit"]),l(yl,{modelValue:L.value,"onUpdate:modelValue":o[4]||(o[4]=m=>L.value=m),fruit:P.value},null,8,["modelValue","fruit"]),l(ae,{modelValue:I.value,"onUpdate:modelValue":o[6]||(o[6]=m=>I.value=m),"max-width":"400"},{default:t(()=>[l(E,null,{default:t(()=>[l(K,null,{default:t(()=>o[30]||(o[30]=[s("确认删除")])),_:1,__:[30]}),l(B,null,{default:t(()=>{var m;return[s(' 确定要删除水果"'+y((m=P.value)==null?void 0:m.name)+'"吗？此操作不可撤销。 ',1)]}),_:1}),l(G,null,{default:t(()=>[l(R),l(U,{text:"",onClick:o[5]||(o[5]=m=>I.value=!1)},{default:t(()=>o[31]||(o[31]=[s("取消")])),_:1,__:[31]}),l(U,{color:"error",onClick:p,loading:d.value},{default:t(()=>o[32]||(o[32]=[s("删除")])),_:1,__:[32]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ye,{modelValue:C.value,"onUpdate:modelValue":o[8]||(o[8]=m=>C.value=m),color:n.value,timeout:"3000"},{actions:t(()=>[l(U,{color:"white",variant:"text",onClick:o[7]||(o[7]=m=>C.value=!1)},{default:t(()=>o[33]||(o[33]=[s("关闭")])),_:1,__:[33]})]),default:t(()=>[s(y(T.value)+" ",1)]),_:1},8,["modelValue","color"])]))}}),Nl=ie(Dl,[["__scopeId","data-v-d05161c2"]]);export{Nl as default};
